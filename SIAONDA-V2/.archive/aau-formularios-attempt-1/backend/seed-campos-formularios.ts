import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('ðŸŒ± Seeding campos dinÃ¡micos de formularios...\n');

  // 1. Crear o verificar tipos de campos
  const tipoTexto = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'texto' },
    update: {},
    create: { nombre: 'texto', descripcion: 'Campo de texto corto' }
  });

  const tipoTextarea = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'textarea' },
    update: {},
    create: { nombre: 'textarea', descripcion: 'Campo de texto largo' }
  });

  const tipoNumerico = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'numerico' },
    update: {},
    create: { nombre: 'numerico', descripcion: 'Campo numÃ©rico' }
  });

  const tipoFecha = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'fecha' },
    update: {},
    create: { nombre: 'fecha', descripcion: 'Campo de fecha' }
  });

  const tipoCheckbox = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'checkbox' },
    update: {},
    create: { nombre: 'checkbox', descripcion: 'Casilla de verificaciÃ³n' }
  });

  const tipoArchivo = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'archivo' },
    update: {},
    create: { nombre: 'archivo', descripcion: 'Campo de carga de archivo' }
  });

  const tipoListado = await prisma.formularioCampoTipo.upsert({
    where: { nombre: 'listado' },
    update: {},
    create: { nombre: 'listado', descripcion: 'Lista desplegable (select)' }
  });

  console.log('âœ… Tipos de campos creados\n');

  // 2. Obtener productos para asociar campos
  const productoMusical = await prisma.producto.findFirst({
    where: { codigo: 'MUS-01' }
  });

  const productoAudiovisual = await prisma.producto.findFirst({
    where: { codigo: 'AUD-01' }
  });

  const productoLiterario = await prisma.producto.findFirst({
    where: { codigo: 'LIT-03' }
  });

  const productoArteVisual = await prisma.producto.findFirst({
    where: { codigo: 'AP-01' }
  });

  const productoCientifico = await prisma.producto.findFirst({
    where: { codigo: 'OC-01' }
  });

  // ================================================
  // CAMPOS PARA OBRAS MUSICALES (MUS-01)
  // ================================================
  if (productoMusical) {
    console.log('ðŸŽµ Creando campos para Obras Musicales...');

    const camposMusical = [
      // TÃ­tulo
      {
        productoId: productoMusical.id,
        tipoId: tipoTexto.id,
        campo: 'titulo_obra',
        titulo: 'TÃ­tulo de la obra',
        descripcion: 'TÃ­tulo completo de la obra musical',
        placeholder: 'Ej: Mi canciÃ³n del corazÃ³n',
        requerido: true,
        orden: 1
      },
      // GÃ©nero musical
      {
        productoId: productoMusical.id,
        tipoId: tipoTexto.id,
        campo: 'genero_musical',
        titulo: 'GÃ©nero musical',
        descripcion: 'GÃ©nero o estilo musical',
        placeholder: 'Ej: Merengue, Bachata, Salsa, Pop, Rock',
        requerido: true,
        orden: 2
      },
      // Ritmo/Forma
      {
        productoId: productoMusical.id,
        tipoId: tipoTexto.id,
        campo: 'ritmo_forma',
        titulo: 'Ritmo o forma musical',
        descripcion: 'Ritmo especÃ­fico de la obra',
        placeholder: 'Ej: 4/4, Vals, Bolero',
        requerido: false,
        orden: 3
      },
      // PaÃ­s de origen
      {
        productoId: productoMusical.id,
        tipoId: tipoTexto.id,
        campo: 'pais_origen',
        titulo: 'PaÃ­s de origen de la obra',
        descripcion: 'PaÃ­s donde se creÃ³ la obra',
        placeholder: 'RepÃºblica Dominicana',
        requerido: true,
        orden: 4
      },
      // AÃ±o de creaciÃ³n
      {
        productoId: productoMusical.id,
        tipoId: tipoNumerico.id,
        campo: 'ano_creacion',
        titulo: 'AÃ±o de creaciÃ³n',
        descripcion: 'AÃ±o en que fue creada la obra',
        placeholder: '2024',
        requerido: true,
        orden: 5
      },
      // Â¿Ha sido grabada?
      {
        productoId: productoMusical.id,
        tipoId: tipoCheckbox.id,
        campo: 'ha_sido_grabada',
        titulo: 'Â¿Ha sido grabada con fines comerciales?',
        descripcion: 'Marque si la obra ya ha sido grabada',
        requerido: false,
        orden: 6,
        grupo: 'grabacion'
      },
      // Nombre del productor fonogrÃ¡fico
      {
        productoId: productoMusical.id,
        tipoId: tipoTexto.id,
        campo: 'nombre_productor',
        titulo: 'Nombre del productor fonogrÃ¡fico',
        descripcion: 'Solo si la obra ha sido grabada',
        placeholder: 'Nombre de la productora o productor',
        requerido: false,
        orden: 7,
        grupo: 'grabacion'
      },
      // AÃ±o de la grabaciÃ³n
      {
        productoId: productoMusical.id,
        tipoId: tipoNumerico.id,
        campo: 'ano_grabacion',
        titulo: 'AÃ±o de creaciÃ³n de la grabaciÃ³n',
        descripcion: 'AÃ±o en que se realizÃ³ la grabaciÃ³n',
        placeholder: '2024',
        requerido: false,
        orden: 8,
        grupo: 'grabacion'
      },
      // DescripciÃ³n
      {
        productoId: productoMusical.id,
        tipoId: tipoTextarea.id,
        campo: 'descripcion_obra',
        titulo: 'Breve descripciÃ³n de la obra',
        descripcion: 'DescripciÃ³n general de la composiciÃ³n musical',
        placeholder: 'Describa brevemente la obra musical, su contenido, mensaje, etc.',
        requerido: true,
        orden: 9
      },
      // Partitura (archivo)
      {
        productoId: productoMusical.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_partitura',
        titulo: 'Partitura (PDF)',
        descripcion: 'Suba la partitura en formato PDF',
        requerido: false,
        orden: 10
      },
      // Audio (archivo)
      {
        productoId: productoMusical.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_audio',
        titulo: 'Audio de la obra (MP3, WAV)',
        descripcion: 'Suba el audio de la obra musical',
        requerido: false,
        orden: 11
      },
    ];

    for (const campo of camposMusical) {
      await prisma.formularioCampo.upsert({
        where: {
          productoId_campo: {
            productoId: campo.productoId!,
            campo: campo.campo
          }
        },
        update: campo,
        create: campo
      });
    }

    console.log(`âœ… ${camposMusical.length} campos creados para Obras Musicales`);
  }

  // ================================================
  // CAMPOS PARA OBRAS AUDIOVISUALES (AUD-01)
  // ================================================
  if (productoAudiovisual) {
    console.log('ðŸŽ¬ Creando campos para Obras Audiovisuales...');

    const camposAudiovisual = [
      // TÃ­tulo
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'titulo_obra',
        titulo: 'TÃ­tulo de la obra audiovisual',
        descripcion: 'TÃ­tulo completo',
        placeholder: 'Ej: El sueÃ±o de una naciÃ³n',
        requerido: true,
        orden: 1
      },
      // Director
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'director',
        titulo: 'Director',
        descripcion: 'Nombre completo del director',
        placeholder: 'Nombre y apellidos',
        requerido: true,
        orden: 2
      },
      // Guionista
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'guionista',
        titulo: 'Guionista',
        descripcion: 'Nombre completo del guionista',
        placeholder: 'Nombre y apellidos',
        requerido: true,
        orden: 3
      },
      // Compositor mÃºsica
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'compositor_musica',
        titulo: 'Compositor de la mÃºsica',
        descripcion: 'Si aplica',
        placeholder: 'Nombre y apellidos',
        requerido: false,
        orden: 4
      },
      // IntÃ©rpretes principales
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTextarea.id,
        campo: 'interpretes',
        titulo: 'IntÃ©rpretes principales',
        descripcion: 'Actores/actrices principales',
        placeholder: 'Liste los nombres separados por comas',
        requerido: false,
        orden: 5
      },
      // GÃ©nero
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'genero',
        titulo: 'GÃ©nero',
        descripcion: 'GÃ©nero cinematogrÃ¡fico',
        placeholder: 'Drama, Comedia, AcciÃ³n, Terror, etc.',
        requerido: true,
        orden: 6
      },
      // PaÃ­s de origen
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'pais_origen',
        titulo: 'PaÃ­s de origen',
        descripcion: 'PaÃ­s de producciÃ³n',
        placeholder: 'RepÃºblica Dominicana',
        requerido: true,
        orden: 7
      },
      // Fecha de terminaciÃ³n
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoFecha.id,
        campo: 'fecha_terminacion',
        titulo: 'Fecha de terminaciÃ³n o creaciÃ³n',
        descripcion: 'Fecha en que se terminÃ³ la obra',
        requerido: true,
        orden: 8
      },
      // DuraciÃ³n
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTexto.id,
        campo: 'duracion',
        titulo: 'DuraciÃ³n de la obra',
        descripcion: 'DuraciÃ³n en minutos',
        placeholder: 'Ej: 90 minutos',
        requerido: true,
        orden: 9
      },
      // Sinopsis
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoTextarea.id,
        campo: 'sinopsis',
        titulo: 'Breve sinopsis del argumento',
        descripcion: 'Resumen de la historia',
        placeholder: 'Describa brevemente el argumento de la obra',
        requerido: true,
        orden: 10
      },
      // Archivo de video
      {
        productoId: productoAudiovisual.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_video',
        titulo: 'Archivo de video (MP4, AVI, MOV)',
        descripcion: 'Suba el video de la obra (hasta 15GB)',
        requerido: false,
        orden: 11
      },
    ];

    for (const campo of camposAudiovisual) {
      await prisma.formularioCampo.upsert({
        where: {
          productoId_campo: {
            productoId: campo.productoId!,
            campo: campo.campo
          }
        },
        update: campo,
        create: campo
      });
    }

    console.log(`âœ… ${camposAudiovisual.length} campos creados para Obras Audiovisuales`);
  }

  // ================================================
  // CAMPOS PARA OBRAS LITERARIAS (LIT-03)
  // ================================================
  if (productoLiterario) {
    console.log('ðŸ“š Creando campos para Obras Literarias...');

    const camposLiterario = [
      // TÃ­tulo
      {
        productoId: productoLiterario.id,
        tipoId: tipoTexto.id,
        campo: 'titulo_obra',
        titulo: 'TÃ­tulo de la obra',
        descripcion: 'TÃ­tulo completo del libro',
        placeholder: 'Ej: Cien aÃ±os de soledad',
        requerido: true,
        orden: 1
      },
      // GÃ©nero literario
      {
        productoId: productoLiterario.id,
        tipoId: tipoTexto.id,
        campo: 'genero_literario',
        titulo: 'GÃ©nero literario',
        descripcion: 'GÃ©nero de la obra',
        placeholder: 'Novela, Cuento, PoesÃ­a, Ensayo, etc.',
        requerido: true,
        orden: 2
      },
      // PaÃ­s de origen
      {
        productoId: productoLiterario.id,
        tipoId: tipoTexto.id,
        campo: 'pais_origen',
        titulo: 'PaÃ­s de origen',
        descripcion: 'PaÃ­s donde se escribiÃ³',
        placeholder: 'RepÃºblica Dominicana',
        requerido: true,
        orden: 3
      },
      // AÃ±o de creaciÃ³n
      {
        productoId: productoLiterario.id,
        tipoId: tipoNumerico.id,
        campo: 'ano_creacion',
        titulo: 'AÃ±o de creaciÃ³n',
        descripcion: 'AÃ±o en que se escribiÃ³',
        placeholder: '2024',
        requerido: true,
        orden: 4
      },
      // Â¿EstÃ¡ publicada?
      {
        productoId: productoLiterario.id,
        tipoId: tipoCheckbox.id,
        campo: 'esta_publicada',
        titulo: 'Â¿La obra estÃ¡ publicada?',
        descripcion: 'Marque si ya fue publicada',
        requerido: false,
        orden: 5,
        grupo: 'publicacion'
      },
      // Fecha de publicaciÃ³n
      {
        productoId: productoLiterario.id,
        tipoId: tipoFecha.id,
        campo: 'fecha_publicacion',
        titulo: 'Fecha de primera publicaciÃ³n',
        descripcion: 'Solo si estÃ¡ publicada',
        requerido: false,
        orden: 6,
        grupo: 'publicacion'
      },
      // NÃºmero de ediciÃ³n
      {
        productoId: productoLiterario.id,
        tipoId: tipoNumerico.id,
        campo: 'numero_edicion',
        titulo: 'NÃºmero de ediciÃ³n',
        descripcion: 'Solo si estÃ¡ publicada',
        placeholder: '1',
        requerido: false,
        orden: 7,
        grupo: 'publicacion'
      },
      // ISBN
      {
        productoId: productoLiterario.id,
        tipoId: tipoTexto.id,
        campo: 'isbn',
        titulo: 'ISBN',
        descripcion: 'NÃºmero ISBN si lo tiene',
        placeholder: '978-0-123456-78-9',
        requerido: false,
        orden: 8,
        grupo: 'publicacion'
      },
      // DescripciÃ³n
      {
        productoId: productoLiterario.id,
        tipoId: tipoTextarea.id,
        campo: 'descripcion_obra',
        titulo: 'Breve descripciÃ³n de la obra',
        descripcion: 'Resumen del contenido',
        placeholder: 'Describa brevemente el contenido de la obra literaria',
        requerido: true,
        orden: 9
      },
      // Manuscrito (archivo)
      {
        productoId: productoLiterario.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_manuscrito',
        titulo: 'Manuscrito o documento (PDF, DOC)',
        descripcion: 'Suba el manuscrito de la obra',
        requerido: false,
        orden: 10
      },
    ];

    for (const campo of camposLiterario) {
      await prisma.formularioCampo.upsert({
        where: {
          productoId_campo: {
            productoId: campo.productoId!,
            campo: campo.campo
          }
        },
        update: campo,
        create: campo
      });
    }

    console.log(`âœ… ${camposLiterario.length} campos creados para Obras Literarias`);
  }

  // ================================================
  // CAMPOS PARA ARTES VISUALES (AP-01)
  // ================================================
  if (productoArteVisual) {
    console.log('ðŸŽ¨ Creando campos para Artes Visuales...');

    const camposArteVisual = [
      // TÃ­tulo
      {
        productoId: productoArteVisual.id,
        tipoId: tipoTexto.id,
        campo: 'titulo_obra',
        titulo: 'TÃ­tulo de la obra',
        descripcion: 'TÃ­tulo de la pieza artÃ­stica',
        placeholder: 'Ej: La noche estrellada',
        requerido: true,
        orden: 1
      },
      // TÃ©cnica
      {
        productoId: productoArteVisual.id,
        tipoId: tipoTexto.id,
        campo: 'tecnica',
        titulo: 'TÃ©cnica utilizada',
        descripcion: 'TÃ©cnica artÃ­stica empleada',
        placeholder: 'Ej: Ã“leo sobre lienzo, Acuarela, Grafito',
        requerido: true,
        orden: 2
      },
      // Dimensiones
      {
        productoId: productoArteVisual.id,
        tipoId: tipoTexto.id,
        campo: 'dimensiones',
        titulo: 'Dimensiones',
        descripcion: 'Medidas de la obra',
        placeholder: 'Ej: 100cm x 80cm',
        requerido: false,
        orden: 3
      },
      // AÃ±o de creaciÃ³n
      {
        productoId: productoArteVisual.id,
        tipoId: tipoNumerico.id,
        campo: 'ano_creacion',
        titulo: 'AÃ±o de creaciÃ³n',
        descripcion: 'AÃ±o en que se creÃ³ la obra',
        placeholder: '2024',
        requerido: true,
        orden: 4
      },
      // PaÃ­s de origen
      {
        productoId: productoArteVisual.id,
        tipoId: tipoTexto.id,
        campo: 'pais_origen',
        titulo: 'PaÃ­s de origen',
        descripcion: 'PaÃ­s donde se creÃ³',
        placeholder: 'RepÃºblica Dominicana',
        requerido: true,
        orden: 5
      },
      // DescripciÃ³n
      {
        productoId: productoArteVisual.id,
        tipoId: tipoTextarea.id,
        campo: 'descripcion_obra',
        titulo: 'Breve descripciÃ³n de la obra',
        descripcion: 'DescripciÃ³n de la pieza artÃ­stica',
        placeholder: 'Describa la obra, su significado, inspiraciÃ³n, etc.',
        requerido: true,
        orden: 6
      },
      // Imagen (archivo)
      {
        productoId: productoArteVisual.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_imagen',
        titulo: 'Imagen de la obra (JPG, PNG)',
        descripcion: 'FotografÃ­a de alta calidad de la obra',
        requerido: false,
        orden: 7
      },
    ];

    for (const campo of camposArteVisual) {
      await prisma.formularioCampo.upsert({
        where: {
          productoId_campo: {
            productoId: campo.productoId!,
            campo: campo.campo
          }
        },
        update: campo,
        create: campo
      });
    }

    console.log(`âœ… ${camposArteVisual.length} campos creados para Artes Visuales`);
  }

  // ================================================
  // CAMPOS PARA OBRAS CIENTÃFICAS (OC-01)
  // ================================================
  if (productoCientifico) {
    console.log('ðŸ”¬ Creando campos para Obras CientÃ­ficas...');

    const camposCientifico = [
      // TÃ­tulo
      {
        productoId: productoCientifico.id,
        tipoId: tipoTexto.id,
        campo: 'titulo_obra',
        titulo: 'TÃ­tulo del proyecto',
        descripcion: 'TÃ­tulo completo',
        placeholder: 'Ej: Proyecto de vivienda unifamiliar',
        requerido: true,
        orden: 1
      },
      // Tipo de proyecto
      {
        productoId: productoCientifico.id,
        tipoId: tipoTexto.id,
        campo: 'tipo_proyecto',
        titulo: 'Tipo de proyecto',
        descripcion: 'ClasificaciÃ³n del proyecto',
        placeholder: 'Residencial, Comercial, Industrial, etc.',
        requerido: true,
        orden: 2
      },
      // UbicaciÃ³n
      {
        productoId: productoCientifico.id,
        tipoId: tipoTexto.id,
        campo: 'ubicacion',
        titulo: 'UbicaciÃ³n del proyecto',
        descripcion: 'Lugar fÃ­sico del proyecto',
        placeholder: 'Ciudad, sector, coordenadas',
        requerido: false,
        orden: 3
      },
      // AÃ±o de creaciÃ³n
      {
        productoId: productoCientifico.id,
        tipoId: tipoNumerico.id,
        campo: 'ano_creacion',
        titulo: 'AÃ±o de creaciÃ³n',
        descripcion: 'AÃ±o del diseÃ±o',
        placeholder: '2024',
        requerido: true,
        orden: 4
      },
      // DescripciÃ³n tÃ©cnica
      {
        productoId: productoCientifico.id,
        tipoId: tipoTextarea.id,
        campo: 'descripcion_tecnica',
        titulo: 'DescripciÃ³n tÃ©cnica del proyecto',
        descripcion: 'Detalles tÃ©cnicos relevantes',
        placeholder: 'Describa caracterÃ­sticas tÃ©cnicas, materiales, especificaciones',
        requerido: true,
        orden: 5
      },
      // Planos (archivo)
      {
        productoId: productoCientifico.id,
        tipoId: tipoArchivo.id,
        campo: 'archivo_planos',
        titulo: 'Planos del proyecto (PDF, DWG, ZIP)',
        descripcion: 'Archivos de planos arquitectÃ³nicos',
        requerido: false,
        orden: 6
      },
    ];

    for (const campo of camposCientifico) {
      await prisma.formularioCampo.upsert({
        where: {
          productoId_campo: {
            productoId: campo.productoId!,
            campo: campo.campo
          }
        },
        update: campo,
        create: campo
      });
    }

    console.log(`âœ… ${camposCientifico.length} campos creados para Obras CientÃ­ficas`);
  }

  console.log('\nâœ… Seed de campos dinÃ¡micos completado!');
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
